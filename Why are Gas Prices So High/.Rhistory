setwd("~/GitHub/Apricitas/Why are Gas Prices So High")
acman::p_load(httr,quantmod,tidyquant,datetime,yearmon,lubridate,readr,stringi,jsonlite,cli,remotes,magick,cowplot,knitr,ghostscript,png,httr,grid,usethis,pacman,rio,ggplot2,ggthemes,quantmod,dplyr,data.table,lubridate,forecast,gifski,av,tidyr,gganimate,zoo,RCurl,Cairo,datetime,stringr,pollster,tidyquant,hrbrthemes,plotly,fredr)
pacman::p_load(httr,quantmod,tidyquant,datetime,yearmon,lubridate,readr,stringi,jsonlite,cli,remotes,magick,cowplot,knitr,ghostscript,png,httr,grid,usethis,pacman,rio,ggplot2,ggthemes,quantmod,dplyr,data.table,lubridate,forecast,gifski,av,tidyr,gganimate,zoo,RCurl,Cairo,datetime,stringr,pollster,tidyquant,hrbrthemes,plotly,fredr)
install_github("keberwein/blscrapeR")
library(blscrapeR)
pacman::p_load(eia)
library(eia)
theme_apricitas <- theme_ft_rc() + #setting the "apricitas" custom theme that I use for my blog
theme(axis.line = element_line(colour = "white"),legend.position = c(.90,.90),legend.text = element_text(size = 14, color = "white"), legend.title =element_text(size = 14),plot.title = element_text(size = 28, color = "white")) #using a modified FT theme and white axis lines for my "theme_apricitas"
apricitas_logo <- image_read("https://github.com/Miles-byte/Apricitas/blob/main/Logo.png?raw=true") #downloading and rasterizing my "Apricitas" blog logo from github
apricitas_logo_rast <- rasterGrob(apricitas_logo, interpolate=TRUE)
GASREGW <- fredr(series_id = "GASREGW") #downloading regular all formulations gas price
RETAIL_GAS <- fredr(series_id = "RSGASS") #downloading advanced retail sales of gas
RETAIL_ALL <- fredr(series_id = "RSXFS") #downloading all retail sales
RETAIL_GAS_ALL <- merge(RETAIL_GAS, RETAIL_ALL, by = "date")
RETAIL_GAS_ALL <- subset(RETAIL_GAS_ALL,select = c(date, value.x, value.y))
colnames(RETAIL_GAS_ALL) <- c("date", "gas", "all")
VMT <- fredr(series_id = "VMTD11", observation_start = as.Date("2018-01-01"))
#downloading expenditure data for consumer units
GAS_EXPEND_BOTTOM1 <- bls_api("CXUGASOILLB0102M", startyear = 1984, endyear = 2003, Sys.getenv("BLS_KEY")) %>%
mutate(date = as.Date(as.yearmon(paste(periodName, year), "%b %Y")))
GAS_EXPEND_BOTTOM2 <- bls_api("CXUGASOILLB0102M", startyear = 2004, endyear = 2020, Sys.getenv("BLS_KEY")) %>%
mutate(date = as.Date(as.yearmon(paste(periodName, year), "%b %Y"))) %>%
subset(select = -latest)
Crude_ProductionWeekly <- eia_series("PET.WCRFPUS2.W", start = "2019")
Crude_ProductionWeekly <- as.data.frame(Crude_ProductionWeekly$data)
Crude_ProductionMonthly <- eia_series("PET.MCRFPUS2.M", start = "2019")
Crude_ProductionMonthly <- as.data.frame(Crude_ProductionMonthly$data)
#crude, gas, and diesel prices
WTIEIA <- eia_series("PET.RWTC.D", start = 2019, end = 2022)
WTIEIA <- as.data.frame(WTIEIA$data) %>% mutate(product = "Crude")
GASEIA <- eia_series("PET.EER_EPMRU_PF4_RGC_DPG.D", start = "2019", end = today())
GASEIA <- as.data.frame(GASEIA$data) %>% mutate(product = "Gasoline")
DIESELEIA <- eia_series("PET.EER_EPD2DXL0_PF4_RGC_DPG.D", start = "2019", end = today())
DIESELEIA <- as.data.frame(DIESELEIA$data) %>% mutate(product = "Diesel")
DIESELEIA <- subset(DIESELEIA, date != as.Date("2022-02-21")) #random date has a 0 here, likely due to some error in EIA
KEROSENEEIA <- eia_series("PET.EER_EPJK_PF4_RGC_DPG.D", start = "2019", end = today())
KEROSENEEIA <- as.data.frame(KEROSENEEIA$data)  %>% mutate(product = "Kerosene_Jet")
REFINERY_CAPACITY <- eia_series("PET.MOCLEUS2.M", start = "2019", end = today())
REFINERY_CAPACITY <- as.data.frame(REFINERY_CAPACITY$data)
REFINERY_OPERATING_CAPACITY <- eia_series("PET.MOCGGUS2.M", start = "2019", end = today())
REFINERY_OPERATING_CAPACITY <- as.data.frame(REFINERY_OPERATING_CAPACITY$data)
#SPR Levels
SPR_LEVEL <- eia_series("PET.WCSSTUS1.W", start = "2019")
SPR_LEVEL <- as.data.frame(SPR_LEVEL$data)
#STEO Crude Production, SPR Drawdowns and Forecasts
STEO_Crude_Production <- eia_series("STEO.COPRPUS.M", start = "2019", end = "2026")
STEO_Crude_Production <- as.data.frame(STEO_Crude_Production$data)
STEO_SPR_Withdrawls <- eia_series("STEO.COSQ_DRAW.M", start = "2019", end = "2026")
STEO_SPR_Withdrawls <- as.data.frame(STEO_SPR_Withdrawls$data)
STEO_SPR_Prod <- merge(STEO_Crude_Production,STEO_SPR_Withdrawls, by = "date")
STEO_WTI <- eia_series("STEO.WTIPUUS.M", start = "2019", end = "2026")
STEO_WTI <- as.data.frame(STEO_WTI$data)
CPI_ELECTRICITY <- fredr(series_id = "CUSR0000SEHF01",observation_start = as.Date("2015-01-01"),realtime_start = NULL, realtime_end = NULL)
CPI_UTILITY_GAS <- fredr(series_id = "CUSR0000SEHF02",observation_start = as.Date("2015-01-01"),realtime_start = NULL, realtime_end = NULL)
CPI_GASOLINE <- fredr(series_id = "CUSR0000SETB01",observation_start = as.Date("2015-01-01"),realtime_start = NULL, realtime_end = NULL)
ggplot() + #plotting VMT
geom_line(data=VMT, aes(x=date,y= value/1000, color= "Vehicle Miles Travelled"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::number_format(suffix = "T"), limits = c(160,300), expand = c(0,0)) +
ylab("VMT, Seasonally Adjusted Annual Rate") +
ggtitle("Life is a Highway") +
labs(caption = "Graph created by @JosephPolitano using BTS data",subtitle = "Despite the Pandemic, Americans are Driving as Much as Ever") +
theme_apricitas + theme(legend.position = c(.7,.90)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2018-01-01")-(.1861*1300), xmax = as.Date("2018-01-01")-(0.049*1300), ymin = 160-(.3*140), ymax = 160) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggplot() + #plotting returns to XOP
annotate("hline", y = 0, yintercept = 0, color = "white", size = .5) +
geom_line(data=XOP, aes(x=date,y= (adjusted/133.1416)-1, color= "XOP"), size = 1.25) +
geom_line(data=SPY, aes(x=date,y= (adjusted/93.76001)-1, color= "SPY"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), limits = c(-1,5), expand = c(0,0)) +
ylab("Total Return since June 2006, %") +
ggtitle("Understanding 'Capital Discipline'") +
labs(caption = "Graph created by @JosephPolitano using Yahoo! Finance data",subtitle = "Exploration and Production Companies Were Wrecked by the 2014 and 2020 Oil Crashes") +
theme_apricitas + theme(legend.position = c(.7,.90)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2006-07-03")-(.1861*5948), xmax = as.Date("2006-07-03")-(0.049*5948), ymin = -1-(.3*6), ymax = -1) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggplot() + #plotting US Crude Production
geom_line(data=Crude_ProductionMonthly, aes(x=date,y= value/1000, color= "US Crude Oil Production (Monthly Official)"), size = 1.25) +
geom_line(data=Crude_ProductionWeekly, aes(x=date,y= value/1000, color= "US Crude Oil Production (Weekly Estimates)"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::number_format(suffix = " MMbbl", accuracy = 1), limits = c(9,14),breaks = c(9,10,11,12,13,14), expand = c(0,0)) +
ylab("Mbbl Per Day") +
ggtitle("Sand Trap") +
labs(caption = "Graph created by @JosephPolitano using EIA data",subtitle = "US Oil Production has not Recovered to Pre-Pandemic Levels, Despite the Jump in Prices") +
theme_apricitas + theme(legend.position = c(.55,.92)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*(today()-as.Date("2019-01-01"))), xmax = as.Date("2019-01-01")-(0.049*(today()-as.Date("2019-01-01"))), ymin = 9-(.3*5), ymax = 9) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggplot() + #plotting US Crude Production
geom_line(data=REFINERY_CAPACITY, aes(x=date,y= value/1000, color= "U.S. Crude Oil Distillation Capacity"), size = 1.25) +
geom_line(data=REFINERY_OPERATING_CAPACITY, aes(x=date,y= value/1000, color= "U.S. Crude Oil Distillation"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::number_format(suffix = " MMbbl", accuracy = 1), limits = c(15,19),breaks = c(15,16,17,18,19), expand = c(0,0)) +
ylab("Mbbl Per Day") +
ggtitle("Unrefined Results") +
labs(caption = "Graph created by @JosephPolitano using EIA data",subtitle = "US Refineries are Running at Nearly Full Capacity") +
theme_apricitas + theme(legend.position = c(.35,.42)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*1400), xmax = as.Date("2019-01-01")-(0.049*1400), ymin = 15-(.3*4), ymax = 15) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggplot() + #plotting US Crude Production
annotate("hline", y = 0, yintercept = 0, color = "white", size = .5) +
geom_line(data=Petrol_Profits, aes(x=Date,y= PETROL_PROFITS, color= "Corporate Profits: Petroleum and Coal Products"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::dollar_format(suffix = "B", accuracy = 1), limits = c(-80,120),breaks = c(-50,0,50,100), expand = c(0,0)) +
ylab("Billions of Dollars, Seasonally Adjusted at Annual Rates") +
ggtitle("Understanding 'Capital Discipline'") +
labs(caption = "Graph created by @JosephPolitano using BEA data",subtitle = "The US Oil Industry Has Followed a Boom-and-Bust Rollercoaster") +
theme_apricitas + theme(legend.position = c(.65,.95)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2001-04-01")-(.1861*5948), xmax = as.Date("2001-04-01")-(0.049*5948), ymin = 3-(.3*11), ymax = 3) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggplot() + #plotting WTI and Baker Hughes
geom_line(data=WTI, aes(x=date,y= adjusted, color= "Crude Oil Price (WTI) (lhs)"), size = 1.25) +
geom_line(data=Baker_Hughes, aes(x=Date,y= RIG_COUNT*.069, color= "Baker Hughes Oil Rig Count (rhs)", group = 1), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::dollar_format(), limits = c(0,150), expand = c(0,0), sec.axis = sec_axis(~.*1/.069, name="Oil Rig Count")) +
ylab("Dollars") +
ggtitle("Understanding 'Capital Discipline'") +
labs(caption = "Graph created by @JosephPolitano using Yahoo! Finance and Baker Hughes data",subtitle = "The Post-2012 Relationship Between Oil Prices and Investment is No Longer Holding") +
theme_apricitas + theme(legend.position = c(.7,.90)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2006-07-01")-(.1861*5948), xmax = as.Date("2006-07-01")-(0.049*5948), ymin = 0-(.3*150), ymax = 0) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggplot() + #plotting Gas Prices
geom_line(data=drop_na(GASREGW), aes(x=date,y= value, color= "US Regular All Formulations Gas Price"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::dollar_format(), limits = c(0,5), expand = c(0,0)) +
ylab("Dollars") +
ggtitle("Pain at the Pump") +
labs(caption = "Graph created by @JosephPolitano using EIA data",subtitle = "Nominal Gas Prices are at Record Highs") +
theme_apricitas + theme(legend.position = c(.7,.90)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("1990-08-20")-(.1861*11000), xmax = as.Date("1990-08-20")-(0.049*11561), ymin = 0-(.3*5), ymax = 0) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggplot() + #plotting Gas Prices
geom_line(data=drop_na(WTIEIA), aes(x=date,y= value, color= "Crude Oil (WTI)"), size = 1.25) +
geom_line(data=drop_na(DIESELEIA), aes(x=date,y= value*42, color= "Diesel"), size = 1.25) +
geom_line(data=drop_na(KEROSENEEIA), aes(x=date,y= value*42, color= "Kerosene Type Jet Fuel"), size = 1.25) +
geom_line(data=drop_na(GASEIA), aes(x=date,y= value*42, color= "Gas (Regular)"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::dollar_format(), limits = c(0,225), expand = c(0,0)) +
ylab("Dollars Per Barrel") +
ggtitle("Dawn of the Spread") +
labs(caption = "Graph created by @JosephPolitano using EIA data",subtitle = "Refinery Spreads are Easing But Still High-Especially for Diesel and Jet Fuel") +
theme_apricitas + theme(legend.position = c(.6,.80)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E"), breaks = c("Crude Oil (WTI)","Gas (Regular)","Diesel","Kerosene Type Jet Fuel")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*1400), xmax = as.Date("2019-01-01")-(0.049*1400), ymin = 0-(.3*225), ymax = 0) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
WTIEIA <- eia_series("PET.RWTC.D", start = 2019, end = today())
WTIEIA <- as.data.frame(WTIEIA$data) %>% mutate(product = "Crude")
ggplot() + #plotting Gas Prices
geom_line(data=drop_na(WTIEIA), aes(x=date,y= value, color= "Crude Oil (WTI)"), size = 1.25) +
geom_line(data=drop_na(DIESELEIA), aes(x=date,y= value*42, color= "Diesel"), size = 1.25) +
geom_line(data=drop_na(KEROSENEEIA), aes(x=date,y= value*42, color= "Kerosene Type Jet Fuel"), size = 1.25) +
geom_line(data=drop_na(GASEIA), aes(x=date,y= value*42, color= "Gas (Regular)"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::dollar_format(), limits = c(0,225), expand = c(0,0)) +
ylab("Dollars Per Barrel") +
ggtitle("Dawn of the Spread") +
labs(caption = "Graph created by @JosephPolitano using EIA data",subtitle = "Refinery Spreads are Easing But Still High-Especially for Diesel and Jet Fuel") +
theme_apricitas + theme(legend.position = c(.6,.80)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E"), breaks = c("Crude Oil (WTI)","Gas (Regular)","Diesel","Kerosene Type Jet Fuel")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*1400), xmax = as.Date("2019-01-01")-(0.049*1400), ymin = 0-(.3*225), ymax = 0) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
SPREADS_Graph <- ggplot() + #plotting Gas Prices
geom_line(data=drop_na(WTIEIA), aes(x=date,y= value, color= "Crude Oil (WTI)"), size = 1.25) +
geom_line(data=drop_na(DIESELEIA), aes(x=date,y= value*42, color= "Diesel"), size = 1.25) +
geom_line(data=drop_na(KEROSENEEIA), aes(x=date,y= value*42, color= "Kerosene Type Jet Fuel"), size = 1.25) +
geom_line(data=drop_na(GASEIA), aes(x=date,y= value*42, color= "Gas (Regular)"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::dollar_format(), limits = c(0,225), expand = c(0,0)) +
ylab("Dollars Per Barrel") +
ggtitle("Dawn of the Spread") +
labs(caption = "Graph created by @JosephPolitano using EIA data",subtitle = "Refinery Spreads are Easing But Still High-Especially for Diesel and Jet Fuel") +
theme_apricitas + theme(legend.position = c(.6,.80)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E"), breaks = c("Crude Oil (WTI)","Gas (Regular)","Diesel","Kerosene Type Jet Fuel")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*1400), xmax = as.Date("2019-01-01")-(0.049*1400), ymin = 0-(.3*225), ymax = 0) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
Spreads_Rbind <- rbind(WTIEIA, GASEIA, DIESELEIA, KEROSENEEIA) %>% pivot_wider(names_from = product, values_from = value)
ggplot() + #plotting Refinery Spreads
geom_line(data=drop_na(Spreads_Rbind), aes(x=date,y= (Diesel*42)-Crude, color= "Diesel"), size = 1.25) +
geom_line(data=drop_na(Spreads_Rbind), aes(x=date,y= (Kerosene_Jet*42)-Crude, color= "Kerosene Type Jet Fuel"), size = 1.25) +
geom_line(data=drop_na(Spreads_Rbind), aes(x=date,y= (Gasoline*42)-Crude, color= "Gas (Regular)"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::dollar_format(), limits = c(-10,125), expand = c(0,0)) +
ylab("Dollars Per Barrel") +
ggtitle("Dawn of the Spread") +
labs(caption = "Graph created by @JosephPolitano using EIA data",subtitle = "Gasoline Spreads Have Eased-But Diesel and Jet Fuel Spreads Remain High") +
theme_apricitas + theme(legend.position = c(.6,.80)) +
scale_color_manual(name= "Refinery Spreads" ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E"), breaks = c("Gas (Regular)","Diesel","Kerosene Type Jet Fuel")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*(today()-as.Date("2019-01-01"))), xmax = as.Date("2019-01-01")-(0.049*(today()-as.Date("2019-01-01"))), ymin = -10-(.3*135), ymax = -10) +
coord_cartesian(clip = "off")
ggplot() + #plotting Crude Futures
annotate("rect", xmin = floor_date(as.Date(today() -33), "month"), xmax = as.Date("2023-12-01"), ymin = -Inf, ymax = Inf, fill = "#EE6055", color = NA, alpha = 0.4) +
annotate("text", label = "Forecast", x = as.Date("2022-05-30"), y = 20, color = "#EE6055", size = 5, alpha = 0.6) +
annotate("text", label = "SPR Refill Target", x = as.Date("2023-05-15"), y = 62, color = "white", size = 4.85) +
annotate("segment", x = floor_date(as.Date(today() -33), "month"), xend = as.Date("2023-12-01"), y = 72, yend = 72, linetype = "dashed", color = "white", size = 1.25) +
annotate("segment", x = floor_date(as.Date(today() -33), "month"), xend = as.Date("2023-12-01"), y = 67, yend = 67, linetype = "dashed", color = "white", size = 1.25) +
geom_line(data=drop_na(STEO_WTI), aes(x=date,y= value, color= "Crude Oil (WTI)"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::dollar_format(), limits = c(0,125), expand = c(0,0)) +
ylab("Dollars Per Barrel") +
ggtitle("Price Pullback") +
labs(caption = "Graph created by @JosephPolitano using EIA STEO data",subtitle = "Oil Prices Have Given Up Most of Their Post-Invasion Gains, But are Expected to Remain High") +
theme_apricitas + theme(legend.position = c(.4,.80)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E"), breaks = c("Crude Oil (WTI)","Gas (Regular)","Diesel","Kerosene Type Jet Fuel")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*(today()+365-as.Date("2019-01-01"))), xmax = as.Date("2019-01-01")-(0.049*(today()+365-as.Date("2019-01-01"))), ymin = 0-(.3*125), ymax = 0) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggplot() + #plotting US Crude Production
annotate("rect", xmin = floor_date(as.Date(today() -33), "month"), xmax = as.Date("2023-12-01"), ymin = -Inf, ymax = Inf, fill = "#EE6055", color = NA, alpha = 0.4) +
annotate("text", label = "Forecast", x = as.Date("2022-04-30"), y = 10.25, color = "#EE6055", size = 5, alpha = 0.6) +
geom_line(data=STEO_SPR_Prod, aes(x=date,y= value.x, color= "US Crude Oil Production"), size = 1.25) +
geom_line(data=STEO_SPR_Prod, aes(x=date,y= value.x+value.y, color= "US Crude Oil Production With Net SPR Withdrawls"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::number_format(suffix = " MMbbl", accuracy = 1), limits = c(9,14),breaks = c(9,10,11,12,13,14), expand = c(0,0)) +
ylab("Mbbl Per Day") +
ggtitle("Sand Trap") +
labs(caption = "Graph created by @JosephPolitano using EIA STEO data",subtitle = "Marginal US Crude Oil Production Will Be Handed From the SPR to the Private Sector") +
theme_apricitas + theme(legend.position = c(.35,.93)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*(today()-as.Date("2019-01-01")+365)), xmax = as.Date("2019-01-01")-(0.049*(today()-as.Date("2019-01-01")+365)), ymin = 9-(.3*5), ymax = 9) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggplot() + #plotting US Crude Production
annotate("rect", xmin = floor_date(as.Date(today() -33), "month"), xmax = as.Date("2023-12-01"), ymin = -Inf, ymax = Inf, fill = "#EE6055", color = NA, alpha = 0.4) +
annotate("text", label = "Forecast", x = as.Date("2022-04-30"), y = 27.5, color = "#EE6055", size = 5, alpha = 0.6) +
geom_line(data=OPEC_Crude_Production_STEO, aes(x=date,y= value, color= "OPEC Crude Oil Production"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::number_format(suffix = " MMbbl", accuracy = 1), limits = c(25,40),breaks = c(25,30,35,40), expand = c(0,0)) +
ylab("Mbbl Per Day") +
ggtitle("OPEC Production") +
labs(caption = "Graph created by @JosephPolitano using EIA STEO data",subtitle = "OPEC Crude Production is Expected to Remain Below the Early 2019 Peak Through 2024") +
theme_apricitas + theme(legend.position = c(.35,.93)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*(today()-as.Date("2019-01-01")+365)), xmax = as.Date("2019-01-01")-(0.049*(today()-as.Date("2019-01-01")+365)), ymin = 25-(.3*15), ymax = 25) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
Large_Solar_Capacity_STEO <- eia_series("STEO.SOEPCAPX_US.M", start = "2019", end = "2026")
Large_Solar_Capacity_STEO <- as.data.frame(Large_Solar_Capacity_STEO$data)
Small_Solar_Capacity_STEO <- eia_series("STEO.SODTC_US.M", start = "2019", end = "2026")
Small_Solar_Capacity_STEO <- as.data.frame(Small_Solar_Capacity_STEO$data)
Solar_Merge_STEO <- merge(Small_Solar_Capacity_STEO,Large_Solar_Capacity_STEO,by = "date")
Wind_Capacity_STEO <- eia_series("STEO.WNEPCAPX_US.M", start = "2019", end = "2026")
Wind_Capacity_STEO <- as.data.frame(Wind_Capacity_STEO$data)
ggplot() + #plotting US Crude Production
annotate("rect", xmin = floor_date(as.Date(today() -33), "month"), xmax = as.Date("2023-12-01"), ymin = -Inf, ymax = Inf, fill = "#EE6055", color = NA, alpha = 0.4) +
annotate("text", label = "Forecast", x = as.Date("2022-04-30"), y = 35, color = "#EE6055", size = 5, alpha = 0.6) +
geom_line(data=Wind_Capacity_STEO, aes(x=date,y= value/1000, color= "US Wind Power Capacity"), size = 1.25) +
geom_line(data=Solar_Merge_STEO, aes(x=date,y= (value.x + value.y)/1000, color= "US Large and Small Scale Solar Power Capacity"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::number_format(suffix = " GW", accuracy = 1), limits = c(0,160),breaks = c(0,50,100,150), expand = c(0,0)) +
ylab("Capacity, GW") +
ggtitle("The Long Term Transition") +
labs(caption = "Graph created by @JosephPolitano using EIA STEO data",subtitle = "US Renewable Power Capacity is Growing Rapidly") +
theme_apricitas + theme(legend.position = c(.35,.93)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*(today()-as.Date("2019-01-01")+365)), xmax = as.Date("2019-01-01")-(0.049*(today()-as.Date("2019-01-01")+365)), ymin = 0-(.3*160), ymax = 0) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggplot() + #plotting US Crude Production
annotate("rect", xmin = floor_date(as.Date(today() -33), "month"), xmax = as.Date("2023-12-01"), ymin = -Inf, ymax = Inf, fill = "#EE6055", color = NA, alpha = 0.4) +
annotate("text", label = "Forecast", x = as.Date("2022-04-30"), y = 35, color = "#EE6055", size = 5, alpha = 0.6) +
geom_line(data=Wind_Capacity_STEO, aes(x=date,y= value/1000, color= "US Wind Power Capacity"), size = 1.25) +
geom_line(data=Solar_Merge_STEO, aes(x=date,y= (value.x + value.y)/1000, color= "US Large and Small Scale Solar Power Capacity"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::number_format(suffix = " GW", accuracy = 1), limits = c(0,200),breaks = c(0,50,100,150), expand = c(0,0)) +
ylab("Capacity, GW") +
ggtitle("The Long Term Transition") +
labs(caption = "Graph created by @JosephPolitano using EIA STEO data",subtitle = "US Renewable Power Capacity is Growing Rapidly") +
theme_apricitas + theme(legend.position = c(.35,.93)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*(today()-as.Date("2019-01-01")+365)), xmax = as.Date("2019-01-01")-(0.049*(today()-as.Date("2019-01-01")+365)), ymin = 0-(.3*160), ymax = 0) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggplot() + #plotting US Crude Production
annotate("rect", xmin = floor_date(as.Date(today() -33), "month"), xmax = as.Date("2023-12-01"), ymin = -Inf, ymax = Inf, fill = "#EE6055", color = NA, alpha = 0.4) +
annotate("text", label = "Forecast", x = as.Date("2022-04-30"), y = 35, color = "#EE6055", size = 5, alpha = 0.6) +
geom_line(data=Wind_Capacity_STEO, aes(x=date,y= value/1000, color= "US Wind Power Capacity"), size = 1.25) +
geom_line(data=Solar_Merge_STEO, aes(x=date,y= (value.x + value.y)/1000, color= "US Large and Small Scale Solar Power Capacity"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::number_format(suffix = " GW", accuracy = 1), limits = c(0,225),breaks = c(0,50,100,150), expand = c(0,0)) +
ylab("Capacity, GW") +
ggtitle("The Long Term Transition") +
labs(caption = "Graph created by @JosephPolitano using EIA STEO data",subtitle = "US Renewable Power Capacity is Growing Rapidly") +
theme_apricitas + theme(legend.position = c(.35,.93)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*(today()-as.Date("2019-01-01")+365)), xmax = as.Date("2019-01-01")-(0.049*(today()-as.Date("2019-01-01")+365)), ymin = 0-(.3*160), ymax = 0) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggplot() + #plotting US Crude Production
annotate("rect", xmin = floor_date(as.Date(today() -33), "month"), xmax = as.Date("2024-12-01"), ymin = -Inf, ymax = Inf, fill = "#EE6055", color = NA, alpha = 0.4) +
annotate("text", label = "Forecast", x = as.Date("2022-04-30"), y = 35, color = "#EE6055", size = 5, alpha = 0.6) +
geom_line(data=Wind_Capacity_STEO, aes(x=date,y= value/1000, color= "US Wind Power Capacity"), size = 1.25) +
geom_line(data=Solar_Merge_STEO, aes(x=date,y= (value.x + value.y)/1000, color= "US Large and Small Scale Solar Power Capacity"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::number_format(suffix = " GW", accuracy = 1), limits = c(0,220),breaks = c(0,50,100,150), expand = c(0,0)) +
ylab("Capacity, GW") +
ggtitle("The Long Term Transition") +
labs(caption = "Graph created by @JosephPolitano using EIA STEO data",subtitle = "US Renewable Power Capacity is Growing Rapidly") +
theme_apricitas + theme(legend.position = c(.35,.93)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*(today()-as.Date("2019-01-01")+365)), xmax = as.Date("2019-01-01")-(0.049*(today()-as.Date("2019-01-01")+365)), ymin = 0-(.3*160), ymax = 0) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggplot() + #plotting US Crude Production
annotate("rect", xmin = floor_date(as.Date(today() -33), "month"), xmax = as.Date("2024-12-01"), ymin = -Inf, ymax = Inf, fill = "#EE6055", color = NA, alpha = 0.4) +
annotate("text", label = "Forecast", x = as.Date("2022-04-30"), y = 35, color = "#EE6055", size = 5, alpha = 0.6) +
geom_line(data=Wind_Capacity_STEO, aes(x=date,y= value/1000, color= "US Wind Power Capacity"), size = 1.25) +
geom_line(data=Solar_Merge_STEO, aes(x=date,y= (value.x + value.y)/1000, color= "US Large and Small Scale Solar Power Capacity"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::number_format(suffix = " GW", accuracy = 1), limits = c(0,220),breaks = c(0,50,100,150), expand = c(0,0)) +
ylab("Capacity, GW") +
ggtitle("The Long Term Transition") +
labs(caption = "Graph created by @JosephPolitano using EIA STEO data",subtitle = "US Renewable Power Capacity is Growing Rapidly") +
theme_apricitas + theme(legend.position = c(.35,.93)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*(today()-as.Date("2019-01-01")+365)), xmax = as.Date("2019-01-01")-(0.049*(today()-as.Date("2019-01-01")+365)), ymin = 0-(.3*220), ymax = 0) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggplot() + #plotting US Crude Production
annotate("rect", xmin = floor_date(as.Date(today() -33), "month"), xmax = as.Date("2024-12-01"), ymin = -Inf, ymax = Inf, fill = "#EE6055", color = NA, alpha = 0.4) +
annotate("text", label = "Forecast", x = as.Date("2022-04-30"), y = 35, color = "#EE6055", size = 5, alpha = 0.6) +
geom_line(data=Wind_Capacity_STEO, aes(x=date,y= value/1000, color= "US Wind Power Capacity"), size = 1.25) +
geom_line(data=Solar_Merge_STEO, aes(x=date,y= (value.x + value.y)/1000, color= "US Large and Small Scale Solar Power Capacity"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::number_format(suffix = " GW", accuracy = 1), limits = c(0,220),breaks = c(0,50,100,150,200), expand = c(0,0)) +
ylab("Capacity, GW") +
ggtitle("The Long Term Transition") +
labs(caption = "Graph created by @JosephPolitano using EIA STEO data",subtitle = "US Renewable Power Capacity is Growing Rapidly") +
theme_apricitas + theme(legend.position = c(.35,.93)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*(today()-as.Date("2019-01-01")+365)), xmax = as.Date("2019-01-01")-(0.049*(today()-as.Date("2019-01-01")+365)), ymin = 0-(.3*220), ymax = 0) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
US_Solar_Wind_Graph <- ggplot() + #plotting US Crude Production
annotate("rect", xmin = floor_date(as.Date(today() -33), "month"), xmax = as.Date("2024-12-01"), ymin = -Inf, ymax = Inf, fill = "#EE6055", color = NA, alpha = 0.4) +
annotate("text", label = "Forecast", x = as.Date("2022-04-30"), y = 35, color = "#EE6055", size = 5, alpha = 0.6) +
geom_line(data=Wind_Capacity_STEO, aes(x=date,y= value/1000, color= "US Wind Power Capacity"), size = 1.25) +
geom_line(data=Solar_Merge_STEO, aes(x=date,y= (value.x + value.y)/1000, color= "US Large and Small Scale Solar Power Capacity"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::number_format(suffix = " GW", accuracy = 1), limits = c(0,220),breaks = c(0,50,100,150,200), expand = c(0,0)) +
ylab("Capacity, GW") +
ggtitle("The Long Term Transition") +
labs(caption = "Graph created by @JosephPolitano using EIA STEO data",subtitle = "US Renewable Power Capacity is Growing Rapidly") +
theme_apricitas + theme(legend.position = c(.35,.93)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*(today()-as.Date("2019-01-01")+365)), xmax = as.Date("2019-01-01")-(0.049*(today()-as.Date("2019-01-01")+365)), ymin = 0-(.3*220), ymax = 0) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
setwd("~/GitHub/Apricitas/Why are Gas Prices So High")
ggsave(dpi = "retina",plot = US_Solar_Wind_Graph, "US Solar and Wind.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
ggplot() + #plotting US Crude Production
annotate("rect", xmin = floor_date(as.Date(today() -33), "month"), xmax = as.Date("2023-12-01"), ymin = -Inf, ymax = Inf, fill = "#EE6055", color = NA, alpha = 0.4) +
annotate("text", label = "Forecast", x = as.Date("2022-04-30"), y = 27.5, color = "#EE6055", size = 5, alpha = 0.6) +
geom_line(data=OPEC_Crude_Production_STEO, aes(x=date,y= value, color= "OPEC Crude Oil Production"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::number_format(suffix = " MMbbl", accuracy = 1), limits = c(25,40),breaks = c(25,30,35,40), expand = c(0,0)) +
ylab("Mbbl Per Day") +
ggtitle("OPEC Production") +
labs(caption = "Graph created by @JosephPolitano using EIA STEO data",subtitle = "OPEC Crude Production is Expected to Remain Below the Early 2019 Peak Through 2024") +
theme_apricitas + theme(legend.position = c(.35,.93)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*(today()-as.Date("2019-01-01")+365)), xmax = as.Date("2019-01-01")-(0.049*(today()-as.Date("2019-01-01")+365)), ymin = 25-(.3*15), ymax = 25) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggplot() + #plotting US Crude Production
annotate("rect", xmin = floor_date(as.Date(today() -33), "month"), xmax = as.Date("2023-12-01"), ymin = -Inf, ymax = Inf, fill = "#EE6055", color = NA, alpha = 0.4) +
annotate("text", label = "Forecast", x = as.Date("2022-04-30"), y = 10.25, color = "#EE6055", size = 5, alpha = 0.6) +
geom_line(data=STEO_SPR_Prod, aes(x=date,y= value.x, color= "US Crude Oil Production"), size = 1.25) +
geom_line(data=STEO_SPR_Prod, aes(x=date,y= value.x+value.y, color= "US Crude Oil Production With Net SPR Withdrawls"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::number_format(suffix = " MMbbl", accuracy = 1), limits = c(9,14),breaks = c(9,10,11,12,13,14), expand = c(0,0)) +
ylab("Mbbl Per Day") +
ggtitle("Sand Trap") +
labs(caption = "Graph created by @JosephPolitano using EIA STEO data",subtitle = "Marginal US Crude Oil Production Will Be Handed From the SPR to the Private Sector") +
theme_apricitas + theme(legend.position = c(.35,.93)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*(today()-as.Date("2019-01-01")+365)), xmax = as.Date("2019-01-01")-(0.049*(today()-as.Date("2019-01-01")+365)), ymin = 9-(.3*5), ymax = 9) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
STEO_Prod_SPR_Graph <- ggplot() + #plotting US Crude Production
annotate("rect", xmin = floor_date(as.Date(today() -33), "month"), xmax = as.Date("2024-12-01"), ymin = -Inf, ymax = Inf, fill = "#EE6055", color = NA, alpha = 0.4) +
annotate("text", label = "Forecast", x = as.Date("2022-04-30"), y = 10.25, color = "#EE6055", size = 5, alpha = 0.6) +
geom_line(data=STEO_SPR_Prod, aes(x=date,y= value.x, color= "US Crude Oil Production"), size = 1.25) +
geom_line(data=STEO_SPR_Prod, aes(x=date,y= value.x+value.y, color= "US Crude Oil Production With Net SPR Withdrawls"), size = 1.25) +
xlab("Date") +
scale_y_continuous(labels = scales::number_format(suffix = " MMbbl", accuracy = 1), limits = c(9,14),breaks = c(9,10,11,12,13,14), expand = c(0,0)) +
ylab("Mbbl Per Day") +
ggtitle("Sand Trap") +
labs(caption = "Graph created by @JosephPolitano using EIA STEO data",subtitle = "Marginal US Crude Oil Production Will Be Handed From the SPR to the Private Sector") +
theme_apricitas + theme(legend.position = c(.35,.93)) +
scale_color_manual(name= NULL ,values = c("#FFE98F","#00A99D","#EE6055","#A7ACD9","#9A348E")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2019-01-01")-(.1861*(today()-as.Date("2019-01-01")+365)), xmax = as.Date("2019-01-01")-(0.049*(today()-as.Date("2019-01-01")+365)), ymin = 9-(.3*5), ymax = 9) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggsave(dpi = "retina",plot = STEO_Prod_SPR_Graph, "STEO Prod Graph.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
