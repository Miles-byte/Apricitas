geom_bar(stat = "identity", position = "stack", color = NA) +
xlab("Date") +
ylab("Change Since Jan 2020, Thousands of Jobs") +
scale_y_continuous(labels = scales::comma_format(accuracy = 1, suffix = "k"), breaks = c(-1000,-750,-500,-250,0,250,500,750), limits = c(-1100,750), expand = c(0,0)) +
ggtitle("The Shape of Housing Job Growth") +
labs(caption = "Graph created by @JosephPolitano using BLS data", subtitle = "Housing Related Employment Has Stalledâ€”Importantly in Credit, Construction, and Contractors") +
theme_apricitas + theme(legend.position = c(.625,.25), legend.spacing.y = unit(0, 'cm'), legend.key.width = unit(0.45, 'cm'), legend.key.height = unit(0.35, "cm"),legend.text = (element_text(size = 13)), legend.title=element_text(size=14)) +#, axis.text.x=element_blank(), axis.title.x=element_blank()) +
scale_fill_manual(name= "Housing-Related Employment, Change Since Jan 2020",values = c("#FFE98F","#EE6055","#00A99D","#9A348E","#A7ACD9","#3083DC","#6A4C93"), breaks = c("Residential Specialty Trade Contractors","Architectural, Engineering, and Interior Design Services","Residential Construction","Property Managers, Real Estate Agents, Appraisers, Lessors, & Related","Housing Related Manufacturing, Mining, and Logging","Housing Related Creditors and Loan Brokers","Housing Related Retailers and Wholesalers")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2020-01-01")-(.1861*(today()-as.Date("2020-01-01"))), xmax = as.Date("2020-01-01")-(0.049*(today()-as.Date("2020-01-01"))), ymin = -1100-(.3*1850), ymax = -1100) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggsave(dpi = "retina",plot = HOUSING_RELATED_EMPLOYMENT_IND_graph, "Housing Related Employment Growth Ind.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
CONSTRUCTION_GROWTH_IND_graph <- ggplot(data = CONSTRUCTION_RBIND, aes(x = date, y = value, fill = name)) + #plotting permanent and temporary job losers
annotate("hline", y = 0, yintercept = 0, color = "white", size = .5) +
geom_bar(stat = "identity", position = "stack", color = NA) +
xlab("Date") +
ylab("Change Since Jan 2020, Thousands of Jobs") +
scale_y_continuous(labels = scales::number_format(accuracy = 1, suffix = "k"), breaks = c(-125,-100,-75,-50,-25,0,25,50,75,100,125), limits = c(-125,125), expand = c(0,0)) +
ggtitle("The Shape of Construction Job Growth") +
labs(caption = "Graph created by @JosephPolitano using BLS data", subtitle = "New Jobs Come From SF Construction and Remodelers Vulnerable to Higher Rates") +
theme_apricitas + theme(legend.position = c(.625,.25)) +#, axis.text.x=element_blank(), axis.title.x=element_blank()) +
scale_fill_manual(name= "Residential Construction Employment, Change Since Jan 2020",values = c("#FFE98F","#EE6055","#00A99D","#9A348E","#A7ACD9","#3083DC","#6A4C93"), breaks = c("Single-Family Construction","Residential Remodelers","Multi-Family Construction","For-Sale Builders")) +
annotation_custom(apricitas_logo_rast, xmin = as.Date("2020-01-01")-(.1861*(today()-as.Date("2020-01-01"))), xmax = as.Date("2020-01-01")-(0.049*(today()-as.Date("2020-01-01"))), ymin = -125-(.3*250), ymax = -125) + #these repeated sections place the logo in the bottom-right of each graph. The first number in all equations is the chart's origin point, and the second number is the exact length of the x or y axis
coord_cartesian(clip = "off")
ggsave(dpi = "retina",plot = CONSTRUCTION_GROWTH_IND_graph, "Construction Growth Ind.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233")
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State)
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State) %>%
#transpose() %>%
gather(key = "date", value = "value", -1)
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value", -1)
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value")
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-2)
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3)
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3, -2)
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro)
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3, -2, -1)
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3, -2, -1) %>%
mutate(date = as.Date(gsub("X","",date), "%Y.%m.%d"))
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3, -2, -1) %>%
mutate(date = as.Date(gsub("X","",date), "%Y.%m.%d")) %>%
mutate(StateCodeFips = str_pad(StateCodeFips, 2, pad = 0))
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3, -2, -1) %>%
mutate(date = as.Date(gsub("X","",date), "%Y.%m.%d")) %>%
mutate(StateCodeFIPS = str_pad(StateCodeFIPS, 2, pad = 0)) %>%
mutate(MunicipalCodeFIPS = str_pad(MunicipalCodeFIPS , 2, pad = 0))
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3, -2, -1) %>%
mutate(date = as.Date(gsub("X","",date), "%Y.%m.%d")) %>%
mutate(StateCodeFIPS = str_pad(StateCodeFIPS, 2, pad = 0)) %>%
mutate(MunicipalCodeFIPS = str_pad(MunicipalCodeFIPS , 3, pad = 0)) %>%
mutate(FIPS = paste0(StateCodeFIPS,MunicipalCodeFIPS))
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3, -2, -1) %>%
mutate(date = as.Date(gsub("X","",date), "%Y.%m.%d")) %>%
mutate(StateCodeFIPS = str_pad(StateCodeFIPS, 2, pad = 0)) %>%
mutate(MunicipalCodeFIPS = str_pad(MunicipalCodeFIPS , 3, pad = 0)) %>%
mutate(FIPS = paste0(StateCodeFIPS,MunicipalCodeFIPS)) %>%
group_by(FIPS)
read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3, -2, -1) %>%
mutate(date = as.Date(gsub("X","",date), "%Y.%m.%d")) %>%
mutate(StateCodeFIPS = str_pad(StateCodeFIPS, 2, pad = 0)) %>%
mutate(MunicipalCodeFIPS = str_pad(MunicipalCodeFIPS , 3, pad = 0)) %>%
mutate(FIPS = paste0(StateCodeFIPS,MunicipalCodeFIPS)) %>%
group_by(FIPS) %>%
mutate(value = (value-lag(value,12))/lag(value,12))
ZHVI_FIPS <- read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3, -2, -1) %>%
mutate(date = as.Date(gsub("X","",date), "%Y.%m.%d")) %>%
mutate(StateCodeFIPS = str_pad(StateCodeFIPS, 2, pad = 0)) %>%
mutate(MunicipalCodeFIPS = str_pad(MunicipalCodeFIPS , 3, pad = 0)) %>%
mutate(FIPS = paste0(StateCodeFIPS,MunicipalCodeFIPS)) %>%
group_by(FIPS) %>%
mutate(value = (value-lag(value,12))/lag(value,12))
View(ZHVI_FIPS)
ZHVI_FIPS <- read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3, -2, -1) %>%
mutate(date = as.Date(gsub("X","",date), "%Y.%m.%d")) %>%
mutate(StateCodeFIPS = str_pad(StateCodeFIPS, 2, pad = 0)) %>%
mutate(MunicipalCodeFIPS = str_pad(MunicipalCodeFIPS , 3, pad = 0)) %>%
mutate(FIPS = paste0(StateCodeFIPS,MunicipalCodeFIPS)) %>%
group_by(FIPS) %>%
mutate(value = (value-lag(value,12))/lag(value,12)) %>%
subset(date == as.Date("2023-01-01"))
ZHVI_FIPS <- read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3, -2, -1) %>%
mutate(date = as.Date(gsub("X","",date), "%Y.%m.%d")) %>%
mutate(StateCodeFIPS = str_pad(StateCodeFIPS, 2, pad = 0)) %>%
mutate(MunicipalCodeFIPS = str_pad(MunicipalCodeFIPS , 3, pad = 0)) %>%
mutate(FIPS = paste0(StateCodeFIPS,MunicipalCodeFIPS)) %>%
group_by(FIPS) %>%
mutate(value = (value-lag(value,12))/lag(value,12)) %>%
subset(date == as.Date("2023-01-31"))
ZHVI_FIPS <- read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3, -2, -1) %>%
mutate(date = as.Date(gsub("X","",date), "%Y.%m.%d")) %>%
mutate(StateCodeFIPS = str_pad(StateCodeFIPS, 2, pad = 0)) %>%
mutate(MunicipalCodeFIPS = str_pad(MunicipalCodeFIPS , 3, pad = 0)) %>%
mutate(FIPS = paste0(StateCodeFIPS,MunicipalCodeFIPS)) %>%
group_by(FIPS) %>%
mutate(value = (value-lag(value,12))/lag(value,12)) %>%
subset(date == as.Date("2023-04-30"))
ZHVI_FIPS <- read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3, -2, -1) %>%
mutate(date = as.Date(gsub("X","",date), "%Y.%m.%d")) %>%
mutate(StateCodeFIPS = str_pad(StateCodeFIPS, 2, pad = 0)) %>%
mutate(MunicipalCodeFIPS = str_pad(MunicipalCodeFIPS , 3, pad = 0)) %>%
mutate(FIPS = paste0(StateCodeFIPS,MunicipalCodeFIPS)) %>%
group_by(FIPS) %>%
mutate(value = (value-lag(value,12))/lag(value,12)) %>%
subset(date == max(date))
pacman::p_load(fips,bea.R,janitor,cli,remotes,magick,cowplot,knitr,ghostscript,png,httr,grid,usethis,pacman,rio,ggplot2,ggthemes,quantmod,dplyr,data.table,lubridate,forecast,gifski,av,tidyr,gganimate,zoo,RCurl,Cairo,datetime,stringr,pollster,tidyquant,hrbrthemes,plotly,fredr)
ZHVI_FIPS <- read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3, -2, -1) %>%
mutate(date = as.Date(gsub("X","",date), "%Y.%m.%d")) %>%
mutate(StateCodeFIPS = str_pad(StateCodeFIPS, 2, pad = 0)) %>%
mutate(MunicipalCodeFIPS = str_pad(MunicipalCodeFIPS , 3, pad = 0)) %>%
mutate(fips = paste0(StateCodeFIPS,MunicipalCodeFIPS)) %>%
group_by(fips) %>%
mutate(value = (value-lag(value,12))/lag(value,12)) %>%
subset(date == max(date))
# Load the US county map data
counties_map <- us_map(regions = "counties")
pacman::p_load(usmap,fips,bea.R,janitor,cli,remotes,magick,cowplot,knitr,ghostscript,png,httr,grid,usethis,pacman,rio,ggplot2,ggthemes,quantmod,dplyr,data.table,lubridate,forecast,gifski,av,tidyr,gganimate,zoo,RCurl,Cairo,datetime,stringr,pollster,tidyquant,hrbrthemes,plotly,fredr)
# Merge your data with the map data
merged_df <- counties_map %>%
left_join(ZHVI_FIPS, by = c("fips" = "fips"))
# Load the US county map data
counties_map <- us_map(regions = "counties")
# Merge your data with the map data
merged_df <- counties_map %>%
left_join(ZHVI_FIPS, by = c("fips" = "fips"))
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = growth)) +
geom_polygon(color = "white") +
scale_fill_viridis(name = "Home Price\nGrowth") +
coord_map("albers", lat0 = 39, lat1 = 45) +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = growth)) +
geom_polygon(color = "white") +
scale_fill_canva(name = "Home Price\nGrowth") +
coord_map("albers", lat0 = 39, lat1 = 45) +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_canva(name = "Home Price\nGrowth") +
coord_map("albers", lat0 = 39, lat1 = 45) +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
pacman::p_load(mapproj,usmap,fips,bea.R,janitor,cli,remotes,magick,cowplot,knitr,ghostscript,png,httr,grid,usethis,pacman,rio,ggplot2,ggthemes,quantmod,dplyr,data.table,lubridate,forecast,gifski,av,tidyr,gganimate,zoo,RCurl,Cairo,datetime,stringr,pollster,tidyquant,hrbrthemes,plotly,fredr)
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_canva(name = "Home Price\nGrowth") +
coord_map("albers", lat0 = 39, lat1 = 45) +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white")
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_canva(name = "Home Price\nGrowth")
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth")
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_map("albers", lat0 = 39, lat1 = 45)
# Create the plot
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_map("albers", lat0 = 39, lat1 = 45) +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth")
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_map("albers", lat0 = 39, lat1 = 45)
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_map("albers", lat0 = 39, lat1 = 45) +
theme_void()
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth")
test_map <- ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_map("albers", lat0 = 39, lat1 = 45) +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
ggsave(dpi = "retina",plot = test_map, "test map.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
sf_use_s2(FALSE)
sf_use_s2
pacman::p_load(maps,mapproj,usmap,fips,bea.R,janitor,cli,remotes,magick,cowplot,knitr,ghostscript,png,httr,grid,usethis,pacman,rio,ggplot2,ggthemes,quantmod,dplyr,data.table,lubridate,forecast,gifski,av,tidyr,gganimate,zoo,RCurl,Cairo,datetime,stringr,pollster,tidyquant,hrbrthemes,plotly,fredr)
sf_use_s2(FALSE)
sf_use_s2
??sf_use_s2(FALSE)
?sf_use_s2(FALSE)
pacman::p_load(tigris,maps,mapproj,usmap,fips,bea.R,janitor,cli,remotes,magick,cowplot,knitr,ghostscript,png,httr,grid,usethis,pacman,rio,ggplot2,ggthemes,quantmod,dplyr,data.table,lubridate,forecast,gifski,av,tidyr,gganimate,zoo,RCurl,Cairo,datetime,stringr,pollster,tidyquant,hrbrthemes,plotly,fredr)
?sf_use_s2(FALSE)
sf_use_s2(FALSE)
sf_use_s2(FALSE)
pacman::p_load(sf,tigris,maps,mapproj,usmap,fips,bea.R,janitor,cli,remotes,magick,cowplot,knitr,ghostscript,png,httr,grid,usethis,pacman,rio,ggplot2,ggthemes,quantmod,dplyr,data.table,lubridate,forecast,gifski,av,tidyr,gganimate,zoo,RCurl,Cairo,datetime,stringr,pollster,tidyquant,hrbrthemes,plotly,fredr)
sf_use_s2(FALSE)
test_map <- ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_map("albers", lat0 = 39, lat1 = 45) +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
ggsave(dpi = "retina",plot = test_map, "test map.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
test2 <- ggplot(data = merged_df, mapping = aes(x = long, y = lat, group = group, fill = growth)) +
geom_polygon(color = "white") +
scale_fill_viridis(name = "Home Price\nGrowth") +
coord_map() +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
test2 <- ggplot(data = merged_df, mapping = aes(x = long, y = lat, group = group, fill = growth)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_map() +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
ggsave(dpi = "retina",plot = test2, "test map.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
merged_df
county_map <- map_data("county")
merged_df_2 <- county_map %>%
left_join(ZHVI_FIPS, by = c("fips" = "fips"))
ZHVI_FIPS
View(county_map)
merged_df_2 <- county_map %>%
mutate(fips = paste0(region, subregion)) %>%
left_join(ZHVI_FIPS, by = c("fips" = "fips"))
county_map <- plot_usmap("counties")$polygons
# Merge your data with the map data
merged_df <- county_map %>%
rename(fips = id) %>%
left_join(ZHVI_FIPS, by = "fips")
county_map <- plot_usmap("counties")
# Merge your data with the map data
merged_df <- county_map %>%
rename(fips = id) %>%
left_join(ZHVI_FIPS, by = "fips")
# Merge your data with the map data
merged_df <- county_map %>%
mutate(fips = id) %>%
left_join(ZHVI_FIPS, by = "fips")
fips
county_map <- usmap("counties")
county_map <- us_map("counties")
# Merge your data with the map data
merged_df <- county_map %>%
mutate(fips = id) %>%
left_join(ZHVI_FIPS, by = "fips")
test_map <- ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_sf(color = "white")
ggsave(dpi = "retina",plot = test_map, "test map.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_sf(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth")
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white")
test_map <- ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_map() +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
ggsave(dpi = "retina",plot = test_map, "test map.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
test_map <- ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_map("albers") +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
ggsave(dpi = "retina",plot = test_map, "test map.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
test_map <- ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_map("mercator", lat0 = 39, lat1 = 45) +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
ggsave(dpi = "retina",plot = test_map, "test map.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
# Create the plot
test_map <- ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_map("mercator") +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
ggsave(dpi = "retina",plot = test_map, "test map.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
test_map <- ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
#coord_map("mercator") +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
ggsave(dpi = "retina",plot = test_map, "test map.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_cartesian() +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
test_map <- ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_map("stereographic") +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
ggsave(dpi = "retina",plot = test_map, "test map.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
sf_use_s2(TRUE)
test_map <- ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_map(coord_map("albers", lat0 = 39, lat1 = 45)) +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
ggsave(dpi = "retina",plot = test_map, "test map.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white")
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth")
ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_map(coord_map("albers", lat0 = 39, lat1 = 45))
p_unload(all)  # Remove all packages using the package manager
# Clear console
cat("\014")  # ctrl+L
rm(list = ls())
dev.off()
pacman::p_load(sf,tigris,maps,mapproj,usmap,fips,bea.R,janitor,cli,remotes,magick,cowplot,knitr,ghostscript,png,httr,grid,usethis,pacman,rio,ggplot2,ggthemes,quantmod,dplyr,data.table,lubridate,forecast,gifski,av,tidyr,gganimate,zoo,RCurl,Cairo,datetime,stringr,pollster,tidyquant,hrbrthemes,plotly,fredr)
theme_apricitas <- theme_ft_rc() + #setting the "apricitas" custom theme that I use for my blog
theme(axis.line = element_line(colour = "white"),legend.position = c(.90,.90),legend.text = element_text(size = 14, color = "white"), legend.title =element_text(size = 14),plot.title = element_text(size = 28, color = "white")) #using a modified FT theme and white axis lines for my "theme_apricitas"
apricitas_logo <- image_read("https://github.com/Miles-byte/Apricitas/blob/main/Logo.png?raw=true") #downloading and rasterizing my "Apricitas" blog logo from github
apricitas_logo_rast <- rasterGrob(apricitas_logo, interpolate=TRUE)
install_github("keberwein/blscrapeR")
library(blscrapeR)
ZHVI_FIPS <- read.csv("https://files.zillowstatic.com/research/public_csvs/zhvi/County_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1684841233") %>%
select(-RegionID, -SizeRank, - RegionType, - StateName, -StateName, - State, - Metro) %>%
#transpose() %>%
gather(key = "date", value = "value",-3, -2, -1) %>%
mutate(date = as.Date(gsub("X","",date), "%Y.%m.%d")) %>%
mutate(StateCodeFIPS = str_pad(StateCodeFIPS, 2, pad = 0)) %>%
mutate(MunicipalCodeFIPS = str_pad(MunicipalCodeFIPS , 3, pad = 0)) %>%
mutate(fips = paste0(StateCodeFIPS,MunicipalCodeFIPS)) %>%
group_by(fips) %>%
mutate(value = (value-lag(value,12))/lag(value,12)) %>%
subset(date == max(date))
# Load the US county map data
counties_map <- us_map(regions = "counties")
merged_df <- counties_map %>%
left_join(ZHVI_FIPS, by = c("fips" = "fips"))
test_map <- ggplot(data = merged_df, mapping = aes(x = x, y = y, group = group, fill = value)) +
geom_polygon(color = "white") +
scale_fill_viridis_b(name = "Home Price\nGrowth") +
coord_map("albers", lat0 = 39, lat1 = 45) +
theme_void() +
theme(plot.background = element_rect(fill = "white"),
legend.position = "bottom",
panel.grid = element_blank(),
legend.title.align = 0.5) +
labs(title = "Heatmap of Home Price Growth in U.S. Counties",
caption = "Source: Your Data Source")
ggsave(dpi = "retina",plot = test_map, "test map.png", type = "cairo-png", width = 9.02, height = 5.76, units = "in")
install.packages(c("cachem", "chron", "cli", "clock", "crul", "dplyr", "DT", "ecb", "evaluate", "fontawesome", "fs", "future.apply", "gargle", "gifski", "httpuv", "httr", "httr2", "labelled", "later", "lme4", "Matrix", "pedquant", "pollster", "processx", "prodlim", "profvis", "ps", "quantmod", "quantreg", "RcppArmadillo", "recipes", "rlang", "RSQLite", "s2", "sass", "scatterpie", "sys", "testthat", "tinytex", "tseries", "tzdb", "units", "V8", "vctrs", "viridisLite", "vroom", "waldo", "wk", "xefun", "xfun", "xml2", "xts", "zip", "zoo"))
install.packages(c("cachem", "chron", "cli", "clock", "crul", "dplyr", "DT", "ecb", "evaluate", "fontawesome", "fs", "future.apply", "gargle", "gifski", "httpuv", "httr", "httr2", "labelled", "later", "lme4", "Matrix", "pedquant", "pollster", "processx", "prodlim", "profvis", "ps", "quantmod", "quantreg", "RcppArmadillo", "recipes", "rlang", "RSQLite", "s2", "sass", "scatterpie", "sys", "testthat", "tinytex", "tseries", "tzdb", "units", "V8", "vctrs", "viridisLite", "vroom", "waldo", "wk", "xefun", "xfun", "xml2", "xts", "zip", "zoo"))
cat("\014")  # ctrl+L
rm(list = ls())
dev.off()
